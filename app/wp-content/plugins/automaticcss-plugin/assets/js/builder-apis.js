import{waitForEl}from"./helpers.js";let sharedFunctions={previewClass:function(e){var t=this.getCurrentElementId();this.getIframeDocument().querySelector(t).classList.add(e)},removePreviewClass:function(e){var t=this.getCurrentElementId();this.isClassAlreadyActive(e)||this.getIframeDocument().querySelector(t).classList.remove(e)},getActiveClassesAsArray:function(){return this.getIframeDocument().querySelector(this.getCurrentElementId()).classList.value.split(" ")}},bricksFunctions={isBricks:!0,deleteClassListItemSelector:"span[data-balloon='Remove']",getIframeDocument:function(){return document.getElementById("bricks-builder-iframe").contentWindow.document},mainInputSelector:"div.active-class",mainPanelSelector:"#bricks-panel-inner",classInputSelector:"#bricks-panel-element-classes > div.bricks-control-popup.bottom > div.input-wrapper > input[type=text]",saveClassSelector:".input-wrapper .actions .create",getVueObj:function(){return document.querySelector("body > .brx-body.main").__vue_app__},getCurrentElementId:function(){var e=this.getVueObj(),t=e.config.globalProperties.$_activeElement._value.settings._cssId;return t?"#"+t:"#brxe-"+e.config.globalProperties.$_activeElement._value.id},findUnusedClass:function(e){var t=this.getUnusedClassListItems();if(null!=t)for(var r of t)if(r.firstElementChild.textContent==e)return r;return null},addClass:function(t){return this.removePreviewClass(t),null==this.getClassListItem(t)&&(this.getUnusedClassListItems(),setTimeout(()=>{let e=document.querySelector(this.classInputSelector);null==(e=document.querySelector(this.classInputSelector))?this.addClass(t):(e.value=t,e.dispatchEvent(new Event("input")),setTimeout(()=>{null==e.parentElement.querySelector(".create")?this.addClass(t):e.parentElement.querySelector(".create").click()},100))},100),!0)},sanitizeCssProperty:(e,t)=>{switch(e){case"_width":return"width";case"_height":return"height";case"_widthMin":return"min-width";case"_heightMin":return"min-height";case"_widthMax":return"max-width";case"_heightMax":return"max-height";case"_top":return"top";case"_right":return"right";case"_bottom":return"bottom";case"_left":return"left";case"width-0":return"border-top-width";case"width-1":return"border-right-width";case"width-2":return"border-bottom-width";case"width-3":return"border-left-width";case"radius-0":return"border-top-left-radius";case"radius-1":return"border-top-right-radius";case"radius-2":return"border-bottom-right-radius";case"radius-3":return"border-bottom-left-radius";case"_typography":return"color";case"_background":return"background-color";case"_border":return"border-color";case"_columnGap":return"column-gap";case"_rowGap":return"row-gap";case"_gradient":return"";case"_border":return"border-color";case"_gridTemplateColumns":return"grid-template-columns";case"_gridGap":return"grid-gap";case"_gridTemplateRows":return"grid-template-rows";case"radius-top":return"border-top-left-radius";case"radius-right":return"border-top-right-radius";case"radius-left":return"border-bottom-left-radius";case"radius-bottom":return"border-bottom-right-radius";default:return"_"==e.charAt(0)?"":e}},getCurrentCssProperty:function(e){let t="";var r=e?.parentElement?.parentElement.classList.contains("handle")?e?.parentElement?.parentElement:null;return r&&r.title?t=r.title:e.parentElement.parentElement.querySelector("label[for]")&&!e.classList.contains("has-dynamic-picker")?t=e.parentElement.parentElement.querySelector("label[for]").getAttribute("for"):e.closest("[controlkey]")?"radius"==(t=e.closest("[controlkey]").getAttribute("controlkey")??"")&&(t="radius-"+e.closest(".handle").classList[1]??""):e.closest(".control-group")&&(t=e.closest(".control-group").querySelector("[data-controlkey]").getAttribute("data-controlkey")??""),this.sanitizeCssProperty(t,e)},removeClass:function(t){var e=this.getClassListItem(t);if(null==e)return!1;e.querySelector(this.deleteClassListItemSelector).click();let r=()=>{var e;this.getIframeDocument().querySelector(this.getCurrentElementId()).classList.contains(t)&&(null!=(e=this.getClassListItem(t))&&e.querySelector(this.deleteClassListItemSelector).click(),setTimeout(r,100))};setTimeout(r,100)},setUnitToNone:function(e){},getCurrentInputOption:function(e){var t=e.closest("[controlkey]")?e.closest("[controlkey]").getAttribute("controlkey"):null;return t&&""!=t?t:this.getCurrentCssProperty(e)},getCurrentSelector:function(){var e=document.querySelector(this.mainInputSelector).querySelector("input").getAttribute("value");return e||document.querySelector(this.mainInputSelector).querySelector("input").getAttribute("placeholder")},getClassListItem:function(e){e="."+e;var t=document.querySelectorAll("#bricks-panel-element-classes > .element-classes > li");if(null!=t)for(var r of t)if(r.firstElementChild.textContent==e)return r;return null},getUnusedClassListItems:function(){let e=document.querySelectorAll(".css-classes ul:last-child li");return 0===e.length&&(document.querySelector(this.mainInputSelector).click(),e=document.querySelectorAll(".css-classes ul:last-child li")),e},isClassAlreadyActive:function(e){return null!=this.getClassListItem(e)},initHoverPreviewEventImplementation:function(t){document.querySelector("#bricks-panel-inner").addEventListener("mouseup",e=>{null!==e.target.closest(this.mainInputSelector)&&0==e.button&&waitForEl(this.classInputSelector).then(()=>{t(),document.querySelector(this.classInputSelector).addEventListener("input",function(){var e=document.querySelector(".css-classes ul:last-child li");null!=e&&"0"!==e.getAttribute("tabindex")&&t()})})});function e(e){if("Enter"==e.key){let e=()=>{null!=document.querySelector(this.classInputSelector)?(t(),document.querySelector(this.classInputSelector).addEventListener("input",function(){var e=document.querySelector(".css-classes ul:last-child li");null!=e&&"0"!==e.getAttribute("tabindex")&&t()})):setTimeout(e,100)};null==document.querySelector(this.classInputSelector)&&setTimeout(e,100)}}document.addEventListener("keydown",e),this.getIframeDocument().addEventListener("keydown",e)},getCurrentInput:function(e){return e},getClassStringFromListItem:function(e){return"."===e.firstElementChild.textContent.charAt(0)?e.firstElementChild.textContent.slice(1):e.firstElementChild.textContent}},oxygenFunctions={getIframeDocument:()=>document.getElementById("ct-artificial-viewport").contentWindow.document,mainInputSelector:".oxygen-active-selector-box",mainPanelSelector:"#oxygen-sidebar",classInputSelector:".oxygen-classes-dropdown-input",saveClassSelector:".input-wrapper .actions .create",getCurrentElementId:function(){return"#"+$scope.iframeScope.findComponentItem($scope.iframeScope.componentsTree.children,$scope.iframeScope.component.active.id,$scope.iframeScope.getComponentItem).options.selector},addClass:function(e){this.removePreviewClass(e),$scope.iframeScope.addSuggestedClassToComponent(e)},removeClass:function(e){$scope.iframeScope.removeComponentClass(e)},isClassAlreadyActive:function(e){if($scope.iframeScope.findComponentItem($scope.iframeScope.componentsTree.children,$scope.iframeScope.component.active.id,$scope.iframeScope.getComponentItem).options.classes)return $scope.iframeScope.findComponentItem($scope.iframeScope.componentsTree.children,$scope.iframeScope.component.active.id,$scope.iframeScope.getComponentItem).options.classes.includes(e)},initHoverPreviewEventImplementation:e=>{document.querySelector(".oxygen-classes-dropdown-input").addEventListener("input",function(){null!=document.querySelector(".oxygen-classes-suggestions > li:first-child")&&e()})},getUnusedClassListItems:function(){return document.querySelectorAll(".oxygen-classes-suggestions > li")},getClassStringFromListItem:function(e){return e.lastElementChild.textContent},getCurrentInputOption:e=>{var t=e.getAttribute("data-option");return null!=t?t:!(!e.previousElementSibling||!e.previousElementSibling.classList.contains("oxygen-color-picker-color"))&&"color"},setUnitToNone:function(e){var t=this.getCurrentInputOption(e);e.parentElement.querySelector(".oxygen-measure-box-units")&&t&&$scope.iframeScope.setOptionUnit(t," ")},getCurrentInput:function(e){return e},getCurrentSelector:function(){return!1},getCurrentCssProperty:function(e){return!1}},builderFunctions={},Builder=(builderFunctions=document.getElementById("ct-artificial-viewport")?oxygenFunctions:bricksFunctions,{...sharedFunctions,...builderFunctions});export{Builder};